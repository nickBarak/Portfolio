<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>Document</title>
</head>
<body>
    <div class="container">

        <div class="partition">

            <div id="overview">
                <strong></strong>
                <div style="margin: 1rem auto 2rem auto;"></div>
                <button class="button"></button>
            </div>
                
            <div id="page">
                
            </div>
        </div>

        <div class="partition">
            <section class="block-swiper swiper-container loading">
                <div class="swiper-wrapper">
                        <div class="swiper-slide" style="background-image:url(img/nav/home.jpg)">
                            <img src="img/nav/home.jpg" class="entity-img" />
                            <p class="title" data-swiper-parallax="-30%" data-swiper-parallax-scale=".75">Home</p>
                        </div>

                        <div class="swiper-slide" style="background-image:url(img/nav/apps.jpg)">
                            <img src="img/nav/apps.jpg" class="entity-img" />
                            <p class="title" data-swiper-parallax="-30%" data-swiper-parallax-scale=".75">Apps</p>
                        </div>

                        <div class="swiper-slide" style="background-image:url(img/nav/skills.jpg)">
                            <img src="img/nav/skills.jpg" class="entity-img" />
                            <p class="title" data-swiper-parallax="-30%" data-swiper-parallax-scale=".7">Skills</p>
                        </div>

                        <div class="swiper-slide" style="background-image:url(img/nav/appendix.jpg)">
                            <img src="img/nav/appendix.jpg" class="entity-img" />
                            <p class="title" data-swiper-parallax="-30%" data-swiper-parallax-scale=".7">Appendix</p>
                        </div>
                </div>
                
                <div class="swiper-pagination swiper-augment"></div>
                <div class="swiper-button-prev swiper-button-white swiper-augment"></div>
                <div class="swiper-button-next swiper-button-white swiper-augment"></div>

                <div class="swiper-help swiper-augment">Spin the block to navigate</div>
            </section>
        </div>

        <div class="header">
            <div class="header-title">My Portfolio</div>
            <div class="header-name">Nick Barak</div>
        </div>

    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/css/swiper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.5.1/js/swiper.min.js"></script>
    <!-- <script src="./index.js"></script> -->
    <script src="./api.js"></script>
    <script>
        function showAppDetails(app) {
            var container = document.getElementsByClassName('app-container')[0];
            [...container.children].filter(({ dataset: { key } }) => Number(key) !== app).forEach((child, i) => {
                child.style.transform = `translateX(${i ? '' : '-'}100vw)`;
                child.children[0].style.borderColor = 'transparent';
                child.children[0].style.height = 0;
                setTimeout(_=> { child.style.display = 'none' }, 300);
            });
            
            
            // if (app) {
                // container.innerHTML = pageContent['Apps'][1][app] + container.innerHTML;
            // } else {
                // container.style.flexDirection = 
            setTimeout(_=> {
                container.style.maxWidth = '80%';
                [...container.children].filter(({ dataset: { key } }) => Number(key) !== app).forEach((child, i) => { child.style.display = 'none' });
                container.innerHTML += pageContent['Apps'][1][app];
                container.children[container.children.length-1].style.opacity = 1;
                container.children[container.children.length-1].style.transform = 'translateY(0)';

                [...container.children[app].children].forEach(({ style }) => { style.cursor = 'auto' });
                container.children[app].addEventListener('mouseover', ({ target: { style } }) => {
                    style.transform = 'scale(1)';
                    style.borderColor = 'black';
                });
            }, 300);
            
                
            // }
            // appDiv.children[app ? 2 : 1].style.opacity = 0;
            // setTimeout(_=> appDiv.children[app ? 2 : 1].style.display = 'none', 150);
            // appDiv.style.flexDirection = 'row';
            // appDiv.style.justifyContent = 'space-around';
            // appDiv.children[app ? 0 : 2].style.opacity = 1;
            
            // pageEl.children[0].style.justifyContent = 'center';
            // pageEl.style.alignItems = 'center';
            // appDiv.style.alignItems = 'center';
        }

        function maximizeSwiper() {
            blockSwiper.el.style.transform = 'scale(1)';
            // blockSwiper.el.style.width = '100%';
            blockSwiper.el.style.cursor = 'grab';
            setTimeout(_=> {
                blockSwiper.el.style.position = 'relative';       
                setTimeout(_=> {
                    blockSwiper.el.style.top = 0;
                    blockSwiper.el.style.right = 0;
                }, 25);
            }, 125);
            blockSwiper.el.removeEventListener('click', maximizeSwiper);
            blockSwiper.attachEvents();
            
            [swiperPaginationEl, swiperArrowLeft, swiperArrowRight].map(({style}) => { style.display = 'block' });

            swiperHelpEl.innerHTML = 'Spin the block to navigate';
            swiperHelpEl.style.fontSize = '1.3rem';

            overviewEl.style.transform = 'translateX(0)';

            pageEl.style.top = '150%';
            setTimeout(_=> { pageEl.style.visibility = 'hidden' }, 300);
        }

        function minimizeSwiper() {
            window.scrollTo(0, 0);
            blockSwiper.el.style.transform = 'scale(.175)';
            blockSwiper.el.style.top = `${window.innerHeight - blockSwiper.el.getBoundingClientRect().top}px`;
            blockSwiper.el.style.right = `${window.innerWidth - blockSwiper.el.getBoundingClientRect().right}px`;
            blockSwiper.el.style.position = 'absolute';
            setTimeout(_=> {
                blockSwiper.el.style.top = '5rem';
                blockSwiper.el.style.right = '5rem';
            }, 100);
            blockSwiper.el.style.cursor = 'pointer';
            blockSwiper.el.addEventListener('click', maximizeSwiper);
            blockSwiper.detachEvents();

            [swiperPaginationEl, swiperArrowLeft, swiperArrowRight].map(({style}) => { style.display = 'none' });

            swiperHelpEl.innerHTML = 'Click to return';
            swiperHelpEl.style.fontSize = '5rem';

            overviewEl.style.transform = 'translateX(-135%)';

            pageEl.style.visibility = 'visible';
            pageEl.style.top = '10rem';
        }


        const overviewEl = document.getElementById('overview'),
            pageEl = document.getElementById('page'),
            [overviewTitle, overviewContent, overviewButton] = overviewEl.children,
            openURL = (url, newTab=true)=> window.open(url, newTab ? '_blank' : '#'),
            loadGitHub = _=> openURL('https://github.com/nickBarak'),
            [swiperHelpEl] = document.getElementsByClassName('swiper-help'),
            [swiperPaginationEl] = document.getElementsByClassName('swiper-pagination'),
            [swiperArrowLeft, swiperArrowRight] = document.getElementsByClassName('swiper-button-white');

        overviewTitle.innerHTML = 'Home';
        overviewButton.addEventListener('click', loadGitHub);


        let blockOptions = {
            init: false,
            loop: true,
            speed:1000,
            slidesPerView: 2,
            centeredSlides : true,
            effect: 'cube',
            coverflowEffect: {
                rotate: 50,
                stretch: 0,
                depth: 100,
                modifier: 1,
                slideShadows : true,
            },
            grabCursor: true,
            parallax: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            // breakpoints: {
            //     1023: {
            //     slidesPerView: 1,
            //     spaceBetween: 0
            //     }
            // },
            // Events
            on: {
                imagesReady: function(){
                this.el.classList.remove('loading');
                }
            }
        };
        let blockSwiper = new Swiper('.block-swiper', blockOptions);
        blockSwiper.init();

        
        overviewContent.innerHTML = overviews['Home'];
        overviewButton.innerHTML = 'My GitHub';

        blockSwiper.on('slideChange', e => {
            let title;
            switch (blockSwiper.realIndex) {
            default: console.log(blockSwiper.realIndex); return;
            case 0:
                title = 'Home';
                break;
            case 1:
                title = 'Apps';
                break;
            case 2:
                title = 'Skills';
                break;
            case 3:
                title = 'Appendix';
            }
            overviewTitle.innerHTML = title;
            overviewContent.innerHTML = overviews[title];
            pageEl.innerHTML = `${pageContent[title][0]}`;
            if (title === 'Home') {
            overviewButton.innerHTML = 'My GitHub';
            overviewButton.addEventListener('click', loadGitHub);
            } else {
            overviewButton.innerHTML = `Click to view ${title.toLowerCase()}`;
            overviewButton.removeEventListener('click', loadGitHub);
            overviewButton.addEventListener('click', minimizeSwiper);
            }
        });
    </script>
</body>
</html>